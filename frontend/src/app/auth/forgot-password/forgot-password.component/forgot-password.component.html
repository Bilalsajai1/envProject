<div class="auth-container">
  <!-- Background animated gradient -->
  <div class="animated-bg">
    <div class="gradient-orb orb-1"></div>
    <div class="gradient-orb orb-2"></div>
  </div>

  <!-- Theme Toggle -->
  <button class="theme-toggle-btn" (click)="toggleTheme()" type="button">
    <div class="toggle-icon-wrapper">
      @if (currentTheme === 'light') {
        <mat-icon class="icon-sun">wb_sunny</mat-icon>
      } @else {
        <mat-icon class="icon-moon">nights_stay</mat-icon>
      }
    </div>
  </button>

  <!-- Main Auth Card -->
  <div class="auth-card-centered">
    <div class="card-header-icon">
      <div class="icon-circle">
        <mat-icon>lock_reset</mat-icon>
      </div>
    </div>

    <div class="card-content">
      <h1 class="card-title">Mot de passe oublié ?</h1>
      <p class="card-subtitle">Pas de problème ! Entrez votre email et nous vous enverrons un lien de réinitialisation.</p>

      @if (success) {
        <div class="success-message">
          <div class="success-icon">
            <mat-icon>check_circle</mat-icon>
          </div>
          <div class="success-content">
            <h3>Email envoyé avec succès !</h3>
            <p>Vérifiez votre boîte mail et suivez les instructions pour réinitialiser votre mot de passe.</p>
          </div>
        </div>
      } @else {
        <form [formGroup]="form" (ngSubmit)="submit()" class="forgot-form">
          <div class="form-group">
            <label class="form-label">
              <mat-icon class="label-icon">email</mat-icon>
              Adresse email
            </label>
            <div class="input-wrapper">
              <input
                type="email"
                formControlName="email"
                class="form-input"
                placeholder="votre@email.com"
                autocomplete="email"
              />
              <div class="input-border"></div>
            </div>
            @if (form.get('email')?.touched && form.get('email')?.hasError('required')) {
              <span class="field-error">L'email est obligatoire</span>
            }
            @if (form.get('email')?.touched && form.get('email')?.hasError('email')) {
              <span class="field-error">Format d'email invalide</span>
            }
          </div>

          <button
            type="submit"
            class="btn-submit"
            [class.loading]="loading"
            [disabled]="loading || form.invalid"
          >
            @if (loading) {
              <div class="btn-loader">
                <div class="loader-spinner"></div>
                <span>Envoi en cours...</span>
              </div>
            } @else {
              <mat-icon class="btn-icon">send</mat-icon>
              <span class="btn-text">Envoyer le lien</span>
            }
          </button>
        </form>
      }

      <button class="btn-back" (click)="goBack()" [disabled]="loading">
        <mat-icon>arrow_back</mat-icon>
        <span>Retour à la connexion</span>
      </button>

      <div class="card-footer">
        <p class="copyright">© 2025 Perenity Software</p>
      </div>
    </div>
  </div>
</div>
