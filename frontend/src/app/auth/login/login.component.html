<div class="auth-container">
  
  <div class="background-image"></div>

  
  <div class="background-overlay"></div>

  
  <button class="theme-toggle-btn" (click)="toggleTheme()" type="button">
    <div class="toggle-icon-wrapper">
      @if (currentTheme === 'light') {
        <mat-icon class="icon-sun">wb_sunny</mat-icon>
      } @else {
        <mat-icon class="icon-moon">nights_stay</mat-icon>
      }
    </div>
  </button>

  
  <div class="auth-card">
    <div class="auth-form-section">
      <div class="logo-header">
        <img src="assets/images/icones/logo-perenity-software.svg" alt="Perenity Software" class="company-logo" />
      </div>

      <div class="form-header">
        <h2 class="form-title">Connexion</h2>
        <p class="form-subtitle">Entrez vos identifiants</p>
      </div>

      @if (error) {
        <div class="alert alert-error">
          <mat-icon>error_outline</mat-icon>
          <div class="alert-content">
            <strong>Erreur</strong>
            <p>{{ error }}</p>
          </div>
          <button class="alert-close" type="button" (click)="error = undefined">
            <mat-icon>close</mat-icon>
          </button>
        </div>
      }

      <form [formGroup]="form" (ngSubmit)="submit()" class="login-form">
        
        <div class="form-group">
          <label class="form-label">
            <mat-icon class="label-icon">person</mat-icon>
            Nom d'utilisateur
          </label>
          <div class="input-wrapper">
            <input
              type="text"
              formControlName="username"
              class="form-input"
              placeholder="votre@email.com"
              autocomplete="username"
            />
            <div class="input-border"></div>
          </div>
          @if (form.get('username')?.touched && form.get('username')?.hasError('required')) {
            <span class="field-error">Ce champ est obligatoire</span>
          }
        </div>

        
        <div class="form-group">
          <label class="form-label">
            <mat-icon class="label-icon">lock</mat-icon>
            Mot de passe
          </label>
          <div class="input-wrapper">
            <input
              [type]="hidePassword ? 'password' : 'text'"
              formControlName="password"
              class="form-input"
              placeholder="••••••••"
              autocomplete="current-password"
            />
            <button
              type="button"
              class="input-action-btn"
              (click)="hidePassword = !hidePassword"
              tabindex="-1"
            >
              <mat-icon>{{ hidePassword ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <div class="input-border"></div>
          </div>
          @if (form.get('password')?.touched && form.get('password')?.hasError('required')) {
            <span class="field-error">Ce champ est obligatoire</span>
          }
        </div>

        
        <div class="form-options">
          <label class="checkbox-label">
            <input type="checkbox" formControlName="rememberMe" />
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">Se souvenir de moi</span>
          </label>
          <a class="link-forgot" (click)="goToForgotPassword()">
            Mot de passe oublié ?
          </a>
        </div>

        
        <button
          type="submit"
          class="btn-submit"
          [class.loading]="loading"
          [disabled]="loading || form.invalid"
        >
          @if (loading) {
            <div class="btn-loader">
              <div class="loader-spinner"></div>
              <span>Connexion en cours...</span>
            </div>
          } @else {
            <span class="btn-text">Se connecter</span>
            <mat-icon class="btn-icon">arrow_forward</mat-icon>
          }
        </button>
      </form>

      
      <div class="form-footer">
        <p class="copyright">© 2025 Perenity Software</p>
      </div>
    </div>
  </div>
</div>

