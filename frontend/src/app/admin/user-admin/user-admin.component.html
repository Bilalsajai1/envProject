<!-- user-admin.component.html (extrait) -->

<div class="page-header">
  <h1>Users</h1>
  <button mat-raised-button color="primary" (click)="openCreateForm()">
    + Nouvel utilisateur
  </button>
</div>

<div class="card light-card">
  <div class="card-header">
    <input
      type="text"
      placeholder="Search (code, nom, email)..."
      [(ngModel)]="search"
      (ngModelChange)="onSearchChange($event)"
    />
  </div>

  <div class="filters-row">
    <input placeholder="Code" [(ngModel)]="filters.code" (ngModelChange)="onFilterChange()" />
    <input placeholder="PrÃ©nom" [(ngModel)]="filters.firstName" (ngModelChange)="onFilterChange()" />
    <input placeholder="Nom" [(ngModel)]="filters.lastName" (ngModelChange)="onFilterChange()" />
    <input placeholder="Email" [(ngModel)]="filters.email" (ngModelChange)="onFilterChange()" />

    <select [(ngModel)]="filters.profilId" (ngModelChange)="onFilterChange()">
      <option [ngValue]="null">Tous profils</option>
      <option *ngFor="let p of profils" [ngValue]="p.id">{{ p.libelle }}</option>
    </select>

    <select [(ngModel)]="filters.actif" (ngModelChange)="onFilterChange()">
      <option [ngValue]="null">Tous</option>
      <option [ngValue]="true">Actifs</option>
      <option [ngValue]="false">Inactifs</option>
    </select>
  </div>

  <table class="table table-striped table-hover light-table">
    <thead>
    <tr>
      <th>Code</th>
      <th>Nom complet</th>
      <th>Email</th>
      <th>Profil</th>
      <th>Actif</th>
      <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let u of users"
        [class.selected]="selectedUser?.id === u.id"
        (click)="onSelect(u)">
      <td>{{ u.code }}</td>
      <td>{{ u.lastName }} {{ u.firstName }}</td>
      <td>{{ u.email }}</td>
      <td>{{ getProfilLibelle(u) }}</td>
      <td>
        <span class="badge" [class.badge-success]="u.actif" [class.badge-danger]="!u.actif">
          {{ u.actif ? 'Oui' : 'Non' }}
        </span>
      </td>
      <td>
        <button mat-icon-button (click)="openEditForm(); $event.stopPropagation()">
          <mat-icon>edit</mat-icon>
        </button>
        <button mat-icon-button color="warn" (click)="deleteUser(u); $event.stopPropagation()">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Paginator (exemple Angular Material) -->
  <mat-paginator
    [length]="totalElements"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[5, 10, 20, 50]"
    (page)="onPageChange($event.pageIndex, $event.pageSize)">
  </mat-paginator>
</div>
