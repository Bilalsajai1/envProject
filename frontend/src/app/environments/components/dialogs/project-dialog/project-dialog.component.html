<div class="project-dialog">

  
  <div class="dialog-header">
    <div class="header-icon">
      <mat-icon>{{ isEdit ? 'edit' : 'add_circle' }}</mat-icon>
    </div>
    <div class="header-text">
      <p class="eyebrow">{{ isEdit ? 'Edition' : 'Création' }}</p>
      <h2>{{ isEdit ? 'Modifier le projet' : 'Nouveau projet' }}</h2>
      <p class="subtitle">{{ isEdit ? 'Mettez à jour les informations du projet.' : 'Créez un projet pour ce type d’environnement.' }}</p>
    </div>
  </div>

  <mat-dialog-content>
    <form [formGroup]="form" class="dialog-form">

      <div class="form-grid">
        <mat-form-field appearance="outline">
          <mat-label>Code projet</mat-label>
          <mat-icon matPrefix>qr_code_2</mat-icon>
          <input matInput formControlName="code" placeholder="Ex: PROJ-001" />
          @if (form.get('code')?.hasError('required')) {
            <mat-error>Code obligatoire</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Libellé</mat-label>
          <mat-icon matPrefix>label</mat-icon>
          <input matInput formControlName="libelle" placeholder="Ex: Projet principal" />
          @if (form.get('libelle')?.hasError('required')) {
            <mat-error>Libellé obligatoire</mat-error>
          }
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          rows="3"
          formControlName="description"
          placeholder="Décrivez le projet..."></textarea>
      </mat-form-field>

      <div class="section">
        <div class="section-header">
          <mat-icon>category</mat-icon>
          <div>
            <h3>Type d'environnement</h3>
            <p>Le projet sera créé dans ce type.</p>
          </div>
        </div>
        <div class="type-chip">
          <mat-icon>label</mat-icon>
          <span class="type-code">{{ envTypeOptions[0]?.code || data.typeCode }}</span>
          <span class="type-libelle" *ngIf="envTypeOptions[0]?.libelle">{{ envTypeOptions[0]?.libelle }}</span>
        </div>
      </div>

      <div class="status-row">
        <div class="status-info">
          <div class="status-icon" [class.active]="form.get('actif')?.value">
            <mat-icon>{{ form.get('actif')?.value ? 'check_circle' : 'pause_circle' }}</mat-icon>
          </div>
          <div>
            <p class="status-title">Statut du projet</p>
            <p class="status-sub">{{ form.get('actif')?.value ? 'Projet actif' : 'Projet inactif' }}</p>
          </div>
        </div>
        <mat-slide-toggle formControlName="actif" color="primary"></mat-slide-toggle>
      </div>

    </form>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-stroked-button (click)="cancel()" [disabled]="saving" class="ghost-btn">
      <mat-icon>close</mat-icon>
      Annuler
    </button>
    <button
      mat-raised-button
      color="primary"
      (click)="save()"
      [disabled]="saving || form.invalid"
      class="primary-btn">
      @if (saving) {
        <mat-progress-spinner mode="indeterminate" diameter="18" strokeWidth="3"></mat-progress-spinner>
        <span>Sauvegarde...</span>
      } @else {
        <mat-icon>{{ isEdit ? 'save' : 'add' }}</mat-icon>
        <span>{{ isEdit ? 'Enregistrer' : 'Créer' }}</span>
      }
    </button>
  </mat-dialog-actions>
</div>

