<div class="login-wrapper">
  <div class="login-container">

    <div class="logo-section">
      <img src="assets/images/perenity_software.png" alt="Perenity Software" class="logo" />
      <h1 class="app-title">Mot de passe oublié</h1>
      <p class="app-subtitle">Entrez votre email pour réinitialiser votre mot de passe</p>
    </div>

    <mat-card class="login-card">

      @if (success) {
        <div class="success-message">
          <mat-icon>check_circle</mat-icon>
          <div>
            <p class="success-title">Email envoyé !</p>
            <p class="success-text">
              Vérifiez votre boîte mail et suivez les instructions pour réinitialiser votre mot de passe.
            </p>
          </div>
        </div>
      }

      @if (!success) {
        <form [formGroup]="form" (ngSubmit)="submit()">

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Adresse email</mat-label>
            <input
              matInput
              type="email"
              formControlName="email"
              autocomplete="email"
            />
            <mat-icon matPrefix>email</mat-icon>

            @if (form.get('email')?.hasError('required')) {
              <mat-error>
                L'email est obligatoire
              </mat-error>
            } @if (form.get('email')?.hasError('email')) {
            <mat-error>
              Email invalide
            </mat-error>
          }
          </mat-form-field>

          <button
            mat-raised-button
            color="primary"
            class="full-width login-button"
            type="submit"
            [disabled]="loading"
          >
            @if (loading) {
              <mat-progress-spinner
                diameter="20"
                mode="indeterminate"
                strokeWidth="2"
                class="spinner">
              </mat-progress-spinner>
              <span>Envoi en cours...</span>
            } @else {
              <span>Envoyer le lien de réinitialisation</span>
            }
          </button>
        </form>
      }

      <button
        mat-button
        class="full-width back-button"
        (click)="goBack()"
      >
        <mat-icon>arrow_back</mat-icon>
        Retour à la connexion
      </button>
    </mat-card>

    <div class="login-footer">
      <p>&copy; 2025 Perenity Software - Tous droits réservés</p>
    </div>
  </div>
</div>
